<%-
  item = @hostgroup || @host
-%>

<%= fields_for item  do |f| %>
<%= f.fields_for 'passwordstate_facet_attributes' do |f| %>
  <%-
    server = item.try :passwordstate_server rescue nil
    server ||= PasswordstateServer.first
    lists = server&.password_lists&.map do |list|
      [ list.password_list_id, "#{list.password_list} - #{list.full_path(true)}" ]
    end || []
    list = item.try :passwordstate_password_list rescue nil
  -%>
  <%= select_f f, :password_list_id, lists, :first, :last,
    { include_blank: true, selected: list&.password_list_id },
    { disabled: lists.empty?,
      help_inline: :indicator,
      label: _('Password List')
    }
  %>
<% end -%>
<% end -%>
